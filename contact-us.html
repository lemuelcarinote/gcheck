<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Pipedrive</title>
    <script>
      (function(ss,ex){
        window.ldfdr=window.ldfdr||function(){(ldfdr._q=ldfdr._q||[]).push([].slice.call(arguments));};
        (function(d,s){
          fs=d.getElementsByTagName(s)[0];
          function ce(src){
            var cs=d.createElement(s);
            cs.src=src;
            cs.async=1;
            fs.parentNode.insertBefore(cs,fs);
          };
          ce('https://sc.lfeeder.com/lftracker_v1_'+ss+(ex?'_'+ex:'')+'.js');
        })(document,'script');
      })('ywVkO4Xqm1waZ6Bj');
    </script>
</head>
<body>
    <div class="pipedriveWebForms" data-pd-webforms="https://webforms.pipedrive.com/f/63mr9LG6cgjg7CXHo4JkIzfgZrKzuWVzwd1QqAm9b4aOc6VJz8XvFRgrbX4mdDYzqH">
        <script src="https://webforms.pipedrive.com/f/loader"></script>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Override fetch
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            const response = await originalFetch(...args);
            console.log('You arrived here...'); // Check if this logs
            if (typeof args[0] === 'string' && args[0].endsWith('/viewed')) {
                console.log('Form viewed');
            }
            return response;
        };

        // Override XMLHttpRequest
        const originalXhrOpen = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function(method, url) {
            this.addEventListener('load', function() {
                console.log('You arrived here...'); // Check if this logs
                if (url.endsWith('/viewed')) {
                    console.log('Form viewed');
                }
            });
            return originalXhrOpen.apply(this, arguments);
        };
    });
    </script>
</body>
</html>
